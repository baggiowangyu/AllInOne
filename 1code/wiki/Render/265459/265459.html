<div class="wikidoc"><h1>Invoke .NET Assembly from Native C++ Code</h1><div style="text-align:right;float:right;">Writer: <a href="http://www.codeplex.com/site/users/view/Jialiang">Jialiang Ge</a></div><div style="clear:both;height:0;">&nbsp;</div> <br /><a href="http://1code.codeplex.com/wikipage?title=Invoke%20.NET%20Assembly%20from%20Native%20C%2b%2b#CLIWrapper">Solution 1. Use a C++/CLI wrapper</a><br /><a href="http://1code.codeplex.com/wikipage?title=Invoke%20.NET%20Assembly%20from%20Native%20C%2b%2b#HostCLR">Solution 2. Host CLR</a><br /><a href="http://1code.codeplex.com/wikipage?title=Invoke%20.NET%20Assembly%20from%20Native%20C%2b%2b#COMInterop">Solution 3. Convert .NET assembly to a COM server, and call it from C++ through .NET-COM interop</a><br /> <br /><a name="CLIWrapper"></a>
<h2>Solution 1. Use a C++/CLI wrapper </h2>Samples: 
<ul><li><b>CSClassLibrary</b> (a C# class library)</li>
<li><b>CppCLINETAssemblyWrapper</b> (a C++/CLI wrapper of the C# class library CSClassLibrary) </li>
<li><b>CppCallNETAssemblyWrapper</b> (a native C++ application that invokes CSClassLibrary through CppCLINETAssemblyWrapper) </li></ul>
The native C++ sample application CppCallNETAssemblyWrapper calls the .NET class defined in the C# class library CSClassLibrary through the C++/CLI wrapper CppCLINETAssemblyWrapper.<br /> <br /><a href="http&#58;&#47;&#47;1code.codeplex.com&#47;releases"><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=1code&DownloadId=119966" alt="Download" title="Download" /></a> Download the <a href="http://1code.codeplex.com/releases/view/44540#DownloadId=119923">All-In-One Code Framework (Library)</a> package.<br /> <br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=1code&DownloadId=119967" alt="CLIWrapper.png" title="CLIWrapper.png" /><br /><br /><a name="HostCLR"></a>
<h2>Solution 2. Host CLR</h2>Samples: 
<ul><li><b>CSClassLibrary</b> (a C# class library)</li>
<li><b>CppHostCLR</b> (a native C++ application that host CLR and load the .NET assembly CSClassLibrary)</li></ul>
The native C++ sample application CppHostCLR hosts CLR, instantiates a type in the .NET assembly CSClassLibrary.dll and calls its methods. Both <a href="http://msdn.microsoft.com/en-us/library/ms164318.aspx">.NET Framework 1.x Hosting Interfaces</a> and <a href="http://msdn.microsoft.com/en-us/library/ms164336.aspx">.NET Framework 2.0 Hosting Interfaces</a> are demonstrated in the code samples.<br /> <br /><a href="http&#58;&#47;&#47;1code.codeplex.com&#47;releases"><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=1code&DownloadId=119966" alt="Download" title="Download" /></a> Download the <a href="http://1code.codeplex.com/releases/view/44540#DownloadId=119923">All-In-One Code Framework (Library)</a> package.<br /> <br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=1code&DownloadId=119969" alt="HostCLR.png" title="HostCLR.png" /><br /><br /><a name="COMInterop"></a>
<h2>Solution 3. Convert .NET assembly to a COM server, and call it from C++ through .NET-COM interop</h2>Samples:
<ul><li><b>CSDllCOMServer</b> (a C# class library converted to an in-process COM server)</li>
<li><b>CppCOMClient</b> (a native C++ application that invokes the C# in-process COM server CSDllCOMServer)</li></ul>
The native C++ sample application CppCOMClient invokes the in-process COM server CSDllCOMServer that was converted from a C# class library.<br /> <br /><a href="http&#58;&#47;&#47;1code.codeplex.com&#47;releases"><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=1code&DownloadId=119966" alt="Download" title="Download" /></a> Download the <a href="http://1code.codeplex.com/releases/view/44540#DownloadId=119919">All-In-One Code Framework (COM)</a> package.<br /> <br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=1code&DownloadId=120019" alt="COMInterop.png" title="COMInterop.png" /></div><div class="ClearBoth"></div>